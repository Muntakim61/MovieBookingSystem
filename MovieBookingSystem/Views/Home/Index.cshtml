@model List<MovieBookingSystem.Models.Movie>
@using System.Linq

@{
    ViewData["Title"] = "Home Page";
    var isAdmin = User.IsInRole("Admin");
    var isUser = User.IsInRole("User");
    var isLoggedIn = User.Identity?.IsAuthenticated ?? false;
}

<!-- Stylesheets -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
        .owl-carousel .item-card {
            display: flex;
            background: #1c1c1e;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            overflow: hidden;
            height: 550px;
            object-fit: contain;
            color: #eee;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .owl-nav button {
            background: #212529;
            border: 2px solid #ffc107;
            color: black;
            font-size: 1.6rem;
            padding: 14px 22px;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.4);
            backdrop-filter: blur(6px);
            transition: all 0.3s ease;
            z-index: 999;
        }

        .owl-nav button:hover {
            background: #ffc107;
            border-color: #212529;
            color: #212529;
            box-shadow: 0 0 30px rgba(255, 193, 7, 0.8);
        }


        .owl-nav .owl-prev {
            left: -35px;
        }

        .owl-nav .owl-next {
            right: -35px;
        }
        .item-card .card-left {
            flex: 1 1 50%;
            padding: 30px 40px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .item-card h3 {
            margin: 0 0 15px 0;
            color: #ffc107;
            font-size: 2rem;
        }

        .item-card p {
            margin: 0 0 25px 0;
            font-size: 1.1rem;
            line-height: 1.4;
        }

        .item-card .btn-details {
            align-self: flex-start;
            background-color: #ffc107;
            color: black;
            font-weight: 600;
            padding: 12px 22px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            text-decoration: none;
            font-size: 1rem;
            box-shadow: 0 3px 8px rgba(255,193,7,0.4);
        }

        .item-card .btn-details:hover {
            background-color: #e0a800;
            color: #111;
            box-shadow: 0 4px 12px rgba(224,168,0,0.6);
        }


        .item-card .card-right {
            flex: 1 1 50%;
            overflow: hidden;
            position: relative;
        }

        .item-card .card-right img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.85);
            transition: transform 0.3s ease;
        }

    
        .blog-allof {
            background: #1c1c1e;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .blog-allof:hover {
            transform: translateY(-6px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
        }

        .img-date img {
            width: 100%;
            height: 400px;
            object-fit: cover;
            filter: brightness(0.8);
        }

        .discretion-blog {
            padding: 20px;
        }

        .discretion-blog h3 {
            color: #ffc107;
            font-size: 24px;
            margin-top: 0;
        }

        .discretion-blog p {
            color: #eee;
            font-size: 16px;
            margin-bottom: 0;
        }
</style>
@* Banner Section *@
<section class="hero-section d-flex align-items-center text-center text-white"
         style="background-image: url('https://i.ibb.co/Y79qq5Zd/LUCA.jpg'); background-position: center center; background-repeat: no-repeat; background-size: cover; min-height: 65vh; position: relative;">

    <div style="background-color: rgba(0, 0, 0, 0.5); position: absolute; top: 0; right: 0; bottom: 0; left: 0;"></div>

    <div class="container position-relative z-2">
        @if (!isLoggedIn)
        {
            
            <h1 class="display-3 fw-bold mb-3">Welcome to ShowTime </h1>
            <p class="lead">Join us to experience effortless movie booking & the joy of cinema!</p>
            <a class="btn btn-warning btn-lg mt-3 text-dark fw-semibold" href="/Movie/GetAllMovies">See All Movies</a>
        }
        else if (isUser)
        {

            <h1 class="display-3 fw-bold mb-3">Welcome Back, @ViewData["FullName"]</h1>
            <p class="lead">Your next cinematic adventure is just a click away.</p>
            <a class="btn btn-outline-light btn-lg mt-3 ms-2 fw-semibold " href="/Booking/UserBookings">My Bookings</a>
        }
        else if (isAdmin)
        {
            
            <h1 class="display-3 fw-bold mb-3">Hello Admin</h1>
            <p class="lead">Manage movies, halls, and user experiences seamlessly.</p>
            <a class="btn btn-warning btn-lg mt-3 text-dark fw-semibold" href="/Home/Admin">Go to Dashboard</a>
            
        }
    </div>
</section>

@* Popular Movies Carousel *@
<section class="popular-movies-carousel user-blog py-5" style="background-color : #ffc107">
    <div class="container">
        <h2 class="text-center text-dark display-5 mb-4 d-flex justify-content-center align-items-center gap-2"
            style="font-family: 'Cinzel', serif; letter-spacing: 2px;">
            <img src="/Images/103271_cinema_icon.png" alt="Cinema Icon" style="height: 45px; width: auto;" />
            Popular Movies
        </h2>

        <div id="owl-demo1" class="owl-carousel owl-theme">
            @foreach (var movie in Model.Take(6))
            {
                <div class="item-card">
                    <div class="card-left">
                        <h3>@movie.Title (@movie.ReleaseDate.Year)</h3>
                        <p>@movie.Genre • $@movie.Price</p>
                        <a href="/Movie/Details/@movie.MovieId" class="btn-details">Details</a>
                    </div>
                    <div class="card-right">
                        <img src="@movie.ImageUrl" alt="@movie.Title" />
                    </div>
                </div>
            }
        </div>
    </div>
</section>

@* Review Section *@
<section class="reviews-section bg-light py-5">
    <div class="container">
        <h2 class="text-center mb-4 display-5" style="font-family: 'Cinzel', serif; letter-spacing: 2px;">What Our Users Say</h2>
        <div class="row justify-content-center">
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100 border-0">
                    <div class="card-body">
                        <p class="card-text">🎬 “Booking tickets has never been this smooth. Loved the UI!”</p>
                        <h6 class="card-subtitle text-muted mt-3">– Aisha, Dhaka</h6>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100 border-0">
                    <div class="card-body">
                        <p class="card-text">🍿 “Great user experience. Found my movie and seats in under 2 minutes.”</p>
                        <h6 class="card-subtitle text-muted mt-3">– Rayhan, Chittagong</h6>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card shadow-sm h-100 border-0">
                    <div class="card-body">
                        <p class="card-text">⭐ “Impressive performance and layout. Highly recommend!”</p>
                        <h6 class="card-subtitle text-muted mt-3">– Farzana, Sylhet</h6>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
@* Newsletter Section *@
<section class="py-5 bg-warning text-dark">
    <div class="container">
        <h2 class="text-center mb-3 display-5" style="font-family: 'Cinzel', serif; letter-spacing: 2px;">Join the ShowTime Club</h2>
        <p class="text-center mb-4 fs-5">Get the latest movie releases, trailers & exclusive updates—right in your inbox!</p>

        <form asp-action="SubscribeNewsletter" asp-controller="Home" method="post" class="row justify-content-center align-items-center g-3">
            @Html.AntiForgeryToken()

            <div class="col-12 col-md-7 col-lg-6">
                <input type="email" class="form-control form-control-lg rounded-3 shadow-sm border-0"
                       name="email" placeholder="Enter your email" required>
            </div>

            <div class="col-12 col-md-5 col-lg-3 d-grid">
                <button type="submit" class="btn btn-warning btn-lg rounded-3 shadow">Subscribe for Updates</button>
            </div>
        </form>


    </div>
</section>




<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
    AOS.init({
        duration: 1000,
        once: false, 
        mirror: false
    });
</script>
<script>
    window.addEventListener('load', function () {
        setTimeout(function () {
            document.querySelectorAll('[data-aos]').forEach(function (el) {
                el.removeAttribute('data-aos');
                el.removeAttribute('data-aos-duration');
                el.removeAttribute('data-aos-delay');
                el.style.opacity = 1;
                el.style.transform = 'none';
            });
            if (AOS) AOS.refreshHard();
        }, 1500); 
    });
</script>
@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script>
        $(document).ready(function () {
            $("#owl-demo1").owlCarousel({
                items: 3,
                loop: true,
                margin: 20,
                nav: true,
                dots: false,
                navText: [
                    '<i class="bi bi-chevron-left"></i>',
                    '<i class="bi bi-chevron-right"></i>'
                ],
                animateIn: 'fadeIn',
                animateOut: 'fadeOut',
                smartSpeed: 600,
                autoplay: false,
                autoplayTimeout: 5000,
                autoplayHoverPause: true,
                responsive: {
                    0: { items: 1 },
                    768: { items: 2 },
                    992: { items: 3 }
                }
            });
        });
    </script>
    @if (TempData["ToastMessage"] != null)
    {
        <script>
            $(document).ready(function () {
                toastr.options = {
                    "closeButton": true,
                    "progressBar": true,
                    "positionClass": "toast-top-right",
                    "timeOut": "5000",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

                toastr["@TempData["ToastType"]"]("@TempData["ToastMessage"]");
            });
        </script>
    }
}

@if (TempData["BookingError"] != null)
{
    <script>
        window.onload = function () {
            alert("@TempData["BookingError"]");
        };
    </script>
}
@if (TempData["NewsletterMessage"] != null)
{
    <script>
        window.onload = function () {
            alert("@TempData["NewsletterMessage"]");
        };
    </script>
}
